{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/home.css' %}"> 
{% endblock %}

{% block title %}MyTravelBook{% endblock %}

{% block content %}
    <div class="home-buttons">
        <a href="{% url 'create_travel_record' %}" class="btn">æ—…è¡Œã‚’è¨˜éŒ²</a>
        {% if latest_travel_record_id %}
            <a href="{% url 'travelmemo_list' latest_travel_record_id %}" class="btn">ãŸã³ãƒ¡ãƒ¢</a>
        {% else %}
            <p>ãŸã³ãƒ¡ãƒ¢ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</p>
        {% endif %}
    </div>

    <!-- æœ€è¿‘ã®æ—…è¡Œ -->
    <div class="recent-travels-container">
        <h2 class="recent-travels-title">ğŸ›«æœ€è¿‘ã®æ—…è¡Œ</h2>
        <div class="recent-travels">
            {% for travel in recent_travels %}
                <div class="travel-item">
                    <a href="{% url 'travel_detail' travel.id %}">
                        <!-- ãƒ¡ã‚¤ãƒ³å†™çœŸ -->
                        {% if travel.main_photo_url %}
                            <img src="{{ travel.main_photo_url.url }}" alt="{{ travel.title }}">
                        {% else %}
                            <img src="{% static 'photos/default.jpg' %}" alt="Default Image">
                        {% endif %}
                        <!-- å„æ—…è¡Œã®ã‚¿ã‚¤ãƒˆãƒ« -->
                        <h3>{{ travel.title }}</h3>
                    </a>
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="roulette-section">
        <p id="nextPrefecture">æ¬¡ã®æ—…è¡Œå…ˆã¯â€¦</p>
        <button id="rouletteButton" class="btn">ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’å›ã™</button>
    </div>

    <script>
    document.getElementById("rouletteButton").addEventListener("click", function() {
        fetch("/roulette/")
        .then(response => response.json())
        .then(data => {
            if (data.prefecture) {
                document.getElementById("nextPrefecture").textContent = "æ¬¡ã®æ—…è¡Œå…ˆã¯ " + data.prefecture;
            } else {
                document.getElementById("nextPrefecture").textContent = "æœªè¨ªå•ã®éƒ½é“åºœçœŒãŒã‚ã‚Šã¾ã›ã‚“";
            }
        });
    });
    </script>
{% endblock %}
